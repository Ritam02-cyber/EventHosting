{% extends "base2.html" %}

{% load static %}

{% block container %}


<!-- {{event.unique_id}} -->


<!-- input to get the start time -->

<input style="display: none;" type="text" name="" id="startTime" value="{{start_time}}" >




{% if event_form %}
<input style="display: none;" id="unique_id" type="text" value="{{event_form.0.unique_id}}">
  
{% endif %}


{% if started %}
  {% if max_reached  %}

  <div class="container p-3">
    <div class="alert alert-warning" role="alert">
        <h4 class="alert-heading">Sorry Max no of participants reached!</h4>
        <p>Aww yeah, you successfully read this important alert message. This example text is going to run a bit longer so that you can see how spacing within an alert works with this kind of content.</p>
        <hr>
        <p class="mb-0">Whenever you need to, be sure to use margin utilities to keep things nice and tidy.</p>
    </div>
  </div>
    

  {% elif event_form %}





  <div class="container p-3">
    <div class="alert alert-info" role="alert">
        <h4 class="alert-heading">Event Started  !!</h4>


        <div style="text-align:center; font-size:2.5rem; background-color:#03dac6; padding:1rem">

          <img style="border-radius: 4px;height:5rem; margin-bottom:1rem" src="{% static 'form-svg.gif'%}"/>
          <br>
          <a class="btn btn-primary" href="{% url 'form_view' event_form.0.unique_id %}">Form Link Here</a>
        </div>
        
        <hr>
        <p class="mb-0">Whenever you need to, be sure to use margin utilities to keep things nice and tidy.</p>
    </div>
  </div>

  {% endif %}
  
{% endif %}

{% if ended %}
<div class="container p-3">
    <div class="alert alert-warning" role="alert">
        <h4 class="alert-heading">Sorry Event Ended !</h4>
        <p>Aww yeah, you successfully read this important alert message. This example text is going to run a bit longer so that you can see how spacing within an alert works with this kind of content.</p>
        <hr>
        <p class="mb-0">Whenever you need to, be sure to use margin utilities to keep things nice and tidy.</p>
    </div>
</div>
  
{% endif %}

{% if not_started %}

<div class="container p-3">
    <div class="alert alert-info" role="alert">
        <h4 class="alert-heading">Event Not Started yet !!</h4>
        <p id="localDate"></p>

        <div style="text-align:center; font-size:2.5rem; background-color:#03dac6; padding:1rem">

          <img style="border-radius: 4px; margin-bottom:1rem" src="{% static 'hourglass.gif'%}"/>
          <p  id="demo"></p>
        </div>
        
        <hr>
        <p class="mb-0">Whenever you need to, be sure to use margin utilities to keep things nice and tidy.</p>
    </div>
</div>
  
{% endif %}




<div class="container mt-3 p-5">


  <div style="border-radius: 20px;" class="card mb-3" id="big-card">
    <img style="max-width:80vw; max-height: 80vh; object-fit: cover; " src="{{event.poster.url}}" class="card-img-top" alt="...">
    <div class="card-body">
      <h3 class="card-title">{{event.title}}</h3>
      <p id="description" class="card-text">{{event.description}}</p>
      <br>
      <p><img src="https://img.icons8.com/ios-glyphs/30/ffffff/gender-neutral-user.png"/>  {{event.host}}</p>
      <p><img style="margin-bottom: 0.2rem; margin-right: 0.4rem;" src="https://img.icons8.com/windows/32/ffffff/conference-foreground-selected.png"/>Max no of participants:  {{event.no_of_participants}}</p>
      <p><img style="margin-bottom: 0.2rem; margin-right: 0.4rem;" src="https://img.icons8.com/windows/32/ffffff/conference-foreground-selected.png"/>No of participants:  {{event.participants.all|length}}</p>
      <p class="text-muted"><img style="margin-bottom:0.2rem; margin-right:0.4rem" src="https://img.icons8.com/ios/30/ffffff/overtime.png"/> Start Time:  {{event.start_time|date:'Y-m-d H:i'}}</p>
      <p class="text-muted"><img style="margin-bottom:0.2rem; margin-right:0.4rem" src="https://img.icons8.com/ios/30/ffffff/overtime.png"/> End Time:  {{event.end_time|date:'Y-m-d H:i'}}</p>
      {% if event.type_of == 'NR' %}

      <p> <img src="https://img.icons8.com/windows/32/ffffff/baby-calendar.png"/>  Normal Event</p>

      {% elif event.type_of == 'GM' %}

      <p> <img src="https://img.icons8.com/external-kiranshastry-solid-kiranshastry/64/ffffff/external-gamepad-appliances-kiranshastry-solid-kiranshastry.png"/>  Gaming Event </p>
        
      {% endif %}

      <h4><span class="badge rounded-pill bg-light text-dark mt-2">
        
      {% if event.result_out %}
        Passed
      {% else %}
      Ongoing
      {% endif %}
      </span></h4>
      
    </div>
  </div>

</div>


<div class="container p-4">


  <div class="card border-primary mb-3">
   
    <div class="card-body text-light">
      <h3 class="card-title mb-3">Rules</h3>
      <p class="card-text">{{event.rules}}</p>
 
    </div>
  </div>


</div>
  
{% endblock container %}



{% block js %}

<script>
    startTime = document.getElementById('startTime').value;
    unique_id = document.getElementById('unique_id');
    console.log(startTime);
    
// Funcion to convert UTC date-time
// to Local date-time

    var theDate = new Date(Date.parse(startTime + ' UTC'));
  
    // document.write("Local date Time: ", 
    //         theDate.toLocaleString());
    localDate = theDate.toLocaleString();
    document.getElementById('localDate').innerHTML =localDate;

    console.log(theDate.toLocaleString());





    // countdown timer
    
    

    
// Set the date we're counting down to
var countDownDate = new Date(localDate).getTime()

// Update the count down every 1 second
var x = setInterval(function() {

  // Get today's date and time
  var now = new Date().getTime();
    
  // Find the distance between now and the count down date
  var distance = countDownDate - now;
    
  // Time calculations for days, hours, minutes and seconds
  var days = Math.floor(distance / (1000 * 60 * 60 * 24));
  var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
  var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
  var seconds = Math.floor((distance % (1000 * 60)) / 1000);
    
  // Output the result in an element with id="demo"
  document.getElementById("demo").innerHTML = days + "d " + hours + "h "
  + minutes + "m " + seconds + "s ";
    
  // If the count down is over, write some text 
  if (distance < 0) {
    clearInterval(x);
    if(unique_id){
      document.getElementById("demo").innerHTML = "<a class='btn btn-outline-primary' href = '/form_view/" + unique_id.value+ "'>Form Link</a>";
    }
    
  }
}, 1000);


</script>
  <!-- fontawesome -->
  <script src="https://use.fontawesome.com/a5af6d7eaf.js"></script>
  <!-- end -->
{% endblock js %}